import React, { useState, useEffect } from 'react';

interface VideoLink {
  id: string;
  title: string;
  url: string;
  description?: string;
}

const VideoLinksApp: React.FC = () => {
  const [isOwner, setIsOwner] = useState(false);
  const [videoLinks, setVideoLinks] = useState<VideoLink[]>([]);
  const [newLink, setNewLink] = useState({ title: '', url: '', description: '' });
  const [showLogin, setShowLogin] = useState(false);
  const [loginPassword, setLoginPassword] = useState('');

  // Load links from localStorage on component mount
  useEffect(() => {
    const savedLinks = localStorage.getItem('videoLinks');
    if (savedLinks) {
      setVideoLinks(JSON.parse(savedLinks));
    }
    
    // Check if owner is already logged in
    const ownerStatus = localStorage.getItem('isOwner');
    if (ownerStatus === 'true') {
      setIsOwner(true);
    }
  }, []);

  // Save links to localStorage whenever they change
  useEffect(() => {
    localStorage.setItem('videoLinks', JSON.stringify(videoLinks));
  }, [videoLinks]);

  const handleLogin = (password: string) => {
    if (password === 'owner123') {
      setIsOwner(true);
      localStorage.setItem('isOwner', 'true');
      setShowLogin(false);
      setLoginPassword('');
    } else {
      alert('Password salah. Hanya pemilik yang dapat mengakses fitur ini.');
    }
  };

  const handleLogout = () => {
    setIsOwner(false);
    localStorage.removeItem('isOwner');
  };

  const addVideoLink = () => {
    if (newLink.title && newLink.url) {
      const newVideoLink: VideoLink = {
        id: Date.now().toString(),
        title: newLink.title,
        url: newLink.url.startsWith('http') ? newLink.url : `https://${newLink.url}`,
        description: newLink.description
      };
      
      setVideoLinks([...videoLinks, newVideoLink]);
      setNewLink({ title: '', url: '', description: '' });
    }
  };

  const deleteVideoLink = (id: string) => {
    setVideoLinks(videoLinks.filter(link => link.id !== id));
  };

  return (
    <div className="min-h-screen bg-black text-white">
      <div className="container mx-auto px-4 max-w-4xl py-8">
        {/* Header */}
        <header className="bg-black p-6 mb-8 border-b border-gray-800">
          <div className="flex justify-between items-center">
            <div className="flex items-center">
              <svg className="w-8 h-8 mr-3 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
              </svg>
              <h1 className="text-3xl font-bold bg-gradient-to-r from-red-500 via-green-500 to-purple-600 bg-clip-text text-transparent">
                Koleksi Video
              </h1>
            </div>
            {isOwner ? (
              <button
                onClick={handleLogout}
                className="bg-gradient-to-r from-red-500 to-purple-600 text-white px-4 py-2 rounded-lg transition-all hover:scale-105"
              >
                Logout
              </button>
            ) : (
              <button
                onClick={() => setShowLogin(true)}
                className="bg-gradient-to-r from-green-500 to-purple-600 text-white px-4 py-2 rounded-lg transition-all hover:scale-105"
              >
                Owner Access
              </button>
            )}
          </div>
          <p className="text-gray-400 mt-2 bg-gradient-to-r from-red-400 via-green-400 to-purple-400 bg-clip-text text-transparent">
            {isOwner 
              ? 'Mode Admin: Tambah dan hapus link video' 
              : 'Klik link untuk menonton video'}
          </p>
        </header>

        {/* Login Modal */}
        {showLogin && (
          <div className="fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50">
            <div className="bg-black border border-gray-800 rounded-lg p-6 w-96">
              <div className="flex items-center mb-4">
                <svg className="w-6 h-6 mr-2 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                </svg>
                <h2 className="text-xl font-bold bg-gradient-to-r from-red-500 to-purple-600 bg-clip-text text-transparent">
                  Akses Khusus Pemilik
                </h2>
              </div>
              <input
                type="password"
                placeholder="Masukkan password rahasia"
                value={loginPassword}
                onChange={(e) => setLoginPassword(e.target.value)}
                className="w-full px-3 py-2 bg-gray-900 border border-gray-800 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 text-white mb-4"
              />
              <div className="flex gap-2">
                <button
                  onClick={() => handleLogin(loginPassword)}
                  className="bg-gradient-to-r from-red-500 to-purple-600 text-white px-4 py-2 rounded-md flex-1 transition-all hover:scale-105"
                >
                  Masuk
                </button>
                <button
                  onClick={() => setShowLogin(false)}
                  className="bg-gray-800 text-white px-4 py-2 rounded-md flex-1 transition-all hover:scale-105"
                >
                  Batal
                </button>
              </div>
            </div>
          </div>
        )}

        {/* Add Link Form (Owner Only) */}
        {isOwner && (
          <div className="bg-black border border-gray-800 rounded-lg p-6 mb-8">
            <h2 className="text-xl font-bold mb-4 bg-gradient-to-r from-red-500 via-green-500 to-purple-600 bg-clip-text text-transparent">
              Tambah Video Baru
            </h2>
            <div className="space-y-3">
              <input
                type="text"
                placeholder="Judul Video"
                value={newLink.title}
                onChange={(e) => setNewLink({...newLink, title: e.target.value})}
                className="w-full px-3 py-2 bg-gray-900 border border-gray-800 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 text-white"
              />
              <input
                type="url"
                placeholder="URL Video"
                value={newLink.url}
                onChange={(e) => setNewLink({...newLink, url: e.target.value})}
                className="w-full px-3 py-2 bg-gray-900 border border-gray-800 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 text-white"
              />
              <textarea
                placeholder="Deskripsi (opsional)"
                value={newLink.description}
                onChange={(e) => setNewLink({...newLink, description: e.target.value})}
                rows={2}
                className="w-full px-3 py-2 bg-gray-900 border border-gray-800 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 text-white"
              />
              <button
                onClick={addVideoLink}
                disabled={!newLink.title || !newLink.url}
                className="w-full bg-gradient-to-r from-red-500 via-green-500 to-purple-600 hover:from-red-600 hover:via-green-600 hover:to-purple-700 disabled:bg-gray-800 text-white px-6 py-2 rounded-md transition-all hover:scale-105 disabled:scale-100"
              >
                + Tambah Video
              </button>
            </div>
          </div>
        )}

        {/* Video Links List */}
        <div className="grid gap-6">
          {videoLinks.length === 0 ? (
            <div className="bg-black border border-gray-800 rounded-lg p-8 text-center">
              <div className="w-32 h-32 mx-auto mb-4 bg-gradient-to-r from-red-500 via-green-500 to-purple-600 rounded-full flex items-center justify-center">
                <svg className="w-16 h-16 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
                </svg>
              </div>
              <h3 className="text-xl font-semibold mb-2 bg-gradient-to-r from-red-400 via-green-400 to-purple-400 bg-clip-text text-transparent">
                Belum ada video
              </h3>
              <p className="text-gray-400">
                {isOwner 
                  ? 'Tambahkan video pertama Anda menggunakan form di atas' 
                  : 'Pemilik belum menambahkan video apa pun'}
              </p>
            </div>
          ) : (
            videoLinks.map((link) => (
              <div key={link.id} className="bg-black border border-gray-800 rounded-lg p-6 transition-all hover:border-red-500 hover:scale-105">
                <div className="flex justify-between items-start mb-3">
                  <h3 className="text-lg font-semibold bg-gradient-to-r from-red-400 via-green-400 to-purple-400 bg-clip-text text-transparent">
                    {link.title}
                  </h3>
                  {isOwner && (
                    <button
                      onClick={() => deleteVideoLink(link.id)}
                      className="text-red-500 hover:text-red-300 ml-2 transition-colors"
                      title="Hapus video"
                    >
                      <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                      </svg>
                    </button>
                  )}
                </div>
                
                {link.description && (
                  <p className="text-gray-400 mb-4">{link.description}</p>
                )}
                
                <a
                  href={link.url}
                  target="_blank"
                  rel="noopener noreferrer"
                  className="inline-flex items-center bg-gradient-to-r from-red-500 to-purple-600 text-white px-4 py-2 rounded-md transition-all hover:scale-105"
                >
                  <svg className="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
                  </svg>
                  Tonton Sekarang
                </a>
              </div>
            ))
          )}
        </div>

        {/* Footer */}
        <footer className="mt-12 text-center text-gray-500 border-t border-gray-800 pt-6">
          <p className="bg-gradient-to-r from-red-400 via-green-400 to-purple-400 bg-clip-text text-transparent">
            © 2024 Video Collection. Akses terbatas untuk pemilik.
          </p>
        </footer>
      </div>
    </div>
  );
};

export default VideoLinksApp;
